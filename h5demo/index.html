<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>demo</title>

    <script type="text/javascript">
        function loadXMLDoc() {
            var xmlhttp;
            if (window.XMLHttpRequest){
                xmlhttp = new XMLHttpRequest();
            } else {
                xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
            }
            xmlhttp.onreadystatechange = function () {
                if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                    document.getElementById("mydiv").innerHTML = xmlhttp.responseText;
                }
            }
            xmlhttp.open("GET", "http://wthrcdn.etouch.cn/weather_mini?city=" + "北京", true);
            xmlhttp.send();
            // 测试
            //document.getElementById("mydiv").innerHTML = "hello zhu";
        }

        function submit() {
            var wdata =
                {
                    data:
                        {
                            weather:
                                {
                                    wendu: 18,
                                    ganmao: '',
                                    yesterday:
                                        {
                                            date: '',
                                            type: '',
                                            fx: '',
                                            fl: '',
                                            low: '',
                                            high: ''
                                        },
                                    forecast:
                                        [
                                            {
                                                date: '',
                                                type: '',
                                                high: '',
                                                low: '',
                                                fengxiang: '',
                                                fengli: ''
                                            },
                                            {
                                                date: '',
                                                type: '',
                                                high: '',
                                                low: '',
                                                fengxiang: '',
                                                fengli: ''
                                            },
                                            {
                                                date: '',
                                                type: '',
                                                high: '',
                                                low: '',
                                                fengxiang: '',
                                                fengli: ''
                                            },
                                            {
                                                date: '',
                                                type: '',
                                                high: '',
                                                low: '',
                                                fengxiang: '',
                                                fengli: ''
                                            },
                                            {
                                                date: '',
                                                type: '',
                                                high: '',
                                                low: '',
                                                fengxiang: '',
                                                fengli: ''
                                            }
                                        ]
                                },
                            today: '',
                            city: '上海',
                            inputCity: ''
                        }
                };
            var xmlhttp;
            if (window.XMLHttpRequest){
                xmlhttp = new XMLHttpRequest();
            } else {
                xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
            }

            var input = document.getElementById("input").value;
            datastr = encodeURI(input);
            var url = "http://wthrcdn.etouch.cn/weather_mini?city=" + datastr;
            xmlhttp.onreadystatechange = function () {
                if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                    document.getElementById("tianqi").innerHTML = xmlhttp.responseText;
                    var weather = xmlhttp.responseText.toJSON();
                    alert(weather[data][city]);
                }
            };
            xmlhttp.open("GET", url, true);
            xmlhttp.send()
        }
    </script>
</head>
<body>
<!-- <button type="button" onclick="loadXMLDoc()">提问</button> -->
<div id="mydiv">
    <div id="input-group">
        <input type="text" id="input" autofocus="autofocus" onkeydown="submitByEnter()"/>
        <button type="button" onclick="submit()">发送</button>
    </div>
</div>

<div id="tianqi"></div>

</body>
</html>